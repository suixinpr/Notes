# join 优化

## 驱动表和被驱动表

**驱动表**在SQL语句执行的过程中，总是先读取；而**被驱动表**在SQL语句执行的过程中，总是后读取。对于常见的 join 如下：

- left join：左表是驱动表，右表是被驱动表。
- right join：右表是驱动表，左表是被驱动表。
- join：小表作为驱动表，大表作为被驱动表。

在 SQL 优化中，永远是**以小表驱动大表**，而在存在索引条件的情况下，**驱动表不会使用索引，被驱动表会使用索引**。

## 半连接&反连接

​	半连接和反连接不是 SQL 标准中的连接查询语法，而是数据库在实现子查询时的一种连接方式，在子查询中存在谓词 **EXIST**、**IN**、**ANY(SOME)** 时一般会用到。具体定义如下：

* **半连接**：返回驱动表中与被驱动表至少匹配一次的数据行，通常体现在 **EXIST**、**IN** 和 **=ANY**。
* **反连接**：返回驱动表中与被驱动表不匹配的数据行，通常体现为 **NOT EXIST**、**NOT IN** 和 **<>ALL**。

常常把主查询中的表当作驱动表，子查询中的表当作被驱动表。

> **驱动表**在SQL语句执行的过程中，总是先读取；而**被驱动表**在SQL语句执行的过程中，总是后读取。注：小表驱动大表是一种常见的查询优化。

半连接能够通过类似 hash join 的方式去查找复合条件的数据，从而避免了两次嵌套循环。